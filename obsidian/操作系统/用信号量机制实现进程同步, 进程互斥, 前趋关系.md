[[信号量机制]]

### 信号量机制实现进程互斥
1. 划定临界区
2. 设置互斥信号量mutex, 处置为1

```c
//没有特别说明时, 可以直接定义剩余资源数, 不用考虑等待队列
semaphore mutex = 1;

P1() {
	P(mutex);
	//临界区代码段
	V(mutex);
}

P2() {
	P(mutex);
	//临界区代码段
	V(mutex);
}
```

注意:
1. 对**不同的临界资源** , 需要设置**不同的互斥信号量**
2. P, V操作必须成对出现

### 信号量机制实现进程同步
[[进程同步与进程互斥#进程同步|进程同步]] 

1. 分析说明地方需要实现同步关系, 即必须保证 **一前一后** 执行的两个操作
2. 设置同步信号量S, **初始值为0**<br>在"前操作"之后执行V(S)<br>在"后操作"之前执行P(S)

即 将 "前操作" 当作一种被占用的资源, 只有"前操作"被执行完了(资源释放了), "后操作"才能执行(才能申请到资源).

```c
//P2的代码4必须在P1的代码1, 代码2之后运行
semaphore S = 0;

P1(){
	//代码1;
	//代码2;
	V(S);
	//代码3;
}

P2() {
	P(S);
	//代码4;
}
```

### 信号量机制实现前驱关系
1. 为每一对前趋关系各设置一个同步信号量
2. "前操作"之后对相应的同步信号量执行V操作
3. "后操作"之前对相应的同步信号量执行P操作