
## 基础分页存储管理
### 基本分页存储管理的概念
将内存空间分为一个个**大小相等的分区**, 每个分区就是一个**页框**( **页框 = 页帧 = 内存块 = 物理块 = 物理页面**) . 每个页框都有一个编号, 即**页框号**(**页框号 = 页帧号 = 内存块号 = 物理块号 = 物理页号**), 页框号 **从0开始** .

将进程的逻辑地址空间也分为 **也页框大小相等** 的一个个部分, 每个部分称为**页** (或**页面**), 每个页面都有一个编号, 即页号, 页号 **从0开始** 

各个页面可以不连续存放, 即可以放在不相邻的各个页框中.

### 页表
为了能知道进程的每个页面在内存中的位置, 每个进程都有一个页表

**页表常保存在PCB中**

页表的样式:

| 页号 | 块号 |
| ---- | ---- |
| 0    | 3    |
| 1    | 6    |
| 2    | 4    |
| ...  | ...  |
| n     | 1     |

1. 一个进程有且只有一个页表
2. 进程的每个页面对应一个页表项
3. 每个页表项由页号和块号组成
4. 页表记录页面和物理块之间的映射关系

内存块的大小 = 页面大小

内存块的数量 = ⌈进程的大小 / 页面的大小⌉

内存块的块号范围 = 0 ~ 内存块数-1

页表项的位数 = 内存块号的位数: 取决于内存块数

i号页表存放的位置: 页面大小 * i



### 如何实现地址转换

如果要访问逻辑地址A, 则:
1. 确定逻辑地址A对应的页号P
2. 找到P号页面在内存中的其实位置
3. 确定逻辑地址A的"页面偏移量"W

页号 = ⌊逻辑地址 / 页面长度⌋

业内偏移量 = 逻辑地址 % 页面长度

实际的物理地址 = 页面在内存中的起始地址 + 业内偏移量

### 逻辑地址结构
如果由K位表示"业内偏移量", 则说明该系统中一个页面的大小未 $2^k$ 个内存单元
如果有M位表示"页号", 则说明一个进程最多有 $2^M$ 个页面

### 地址转换
通常在系统中会设置一个 **页表寄存器(PTR)** , 存放**页表在内存中的起始地址F** 和 **页表长度M**. 

进程未执行时, 页表的起始地址和页表长度保存在PCB中, 当进程被调度时, 操作系统内核会把它们放到页表寄存器中.

地址转换过程如下:

![](https://gitee.com/four_four/picgo/raw/master/img/20211228184845.png)

注意: $P >= M时会发生越界中断$ 

$$页表项地址 = 页表起始地址F + 页号P * 页表项长度$$

$$物理地址E=内存块号b * 页面大小L + W$$ 
**页式管理中地址是一维的** , 即寻址时只需要给出一个逻辑地址

